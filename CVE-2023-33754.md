## Overview
---
â€œ**_WiFi Captive Portal Inpiazza Cloud_**" is a captive portal for connecting to **Inpiazza Cloud** WiFi networks that allows access to the network by entering a telephone number and password.

### Vulnerability Description
Before version **4.2.17** it was possible to perform a user enumeration *(enumerate the telephone numbers)* using the password recovery function offered by the portal. By requesting a new password, it is possible to receive a different message based on the presence or absence of that number within the system. Forward the generated password is always 8 digits and numeric only allowing bruteforcing once you know the phone number.

Username enumeration is the process of developing a list of all valid usernames on a server or web application. It becomes possible if the server or application provides a clue as to whether or not the username exists.

The CVE Program has assigned the ID CVE-2023-20255 to this issue. This is a record on the [CVE List](https://cve.mitre.org/cve/), which standardizes names for security problems:

**CVE ID: CVE-2023-33754** --> https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-33754

### Impacts
This vulnerability allows an attacker to enumerate all user can access to a WiFi Network and can bruteforce the password.

## CVE-2023-33754 - User Enumeration

### Proof of concept (POC)
#### Reproducing Steps
First you need to connect to the WiFi network and open any tab in the browser to bring up the captive portal.
Trying to access the CaptivePortal as shown in the image below, 2 options are made available.
- Enter the telephone number and then the password to log in
- Create new account

![immagine](https://github.com/Alkatraz97/CVEs/assets/46528079/59930605-e1fe-4acf-8bc8-076a2be866fd)

By entering any phone number, the third option opens, which is to recover an account.

![immagine](https://github.com/Alkatraz97/CVEs/assets/46528079/a235863c-9630-4ef9-9690-c2769bddd383)

By pressing the **Recover Data** button, you are redirected to a new page where you can enter the telephone number for which you wish to generate a new password which will be sent via SMS.

![immagine](https://github.com/Alkatraz97/CVEs/assets/46528079/6c57188a-1ad0-474a-b607-1a3a337f69b5)

On this page, by intercepting the *Request* and analyzing the *Response* sent by the Server, it is possible to identify which accounts are active and which are not.

As visible in the 2 images below, if the number is present in the system, the *"success"* parameter is set to *"True"*; otherwise the parameter is set to **"error_account_not_exists"**.

![immagine](https://github.com/Alkatraz97/CVEs/assets/46528079/776f3826-42ca-44cf-87b6-e39dc2e45e12)

![immagine](https://github.com/Alkatraz97/CVEs/assets/46528079/e55cb986-342d-4196-a768-a42917e763f6)

Thanks to these messages it is possible to Enumerate the registered Accounts and through a Brute Force attack to find the password and log in with their usernames.
Furthermore, the password that is generated and sent always has a fixed length of 8 characters including only letters and numbers, thus reducing the time necessary for the Brute Force phase.

### Discovered by
#### [Kevin Riva](https://www.linkedin.com/in/kevin-riva-6338ba267/) of [Cybertech srl](https://www.cybertech.eu/)
