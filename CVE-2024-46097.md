## Overview
---
â€œ**TestLink Open Source Test Management**".

### Vulnerability Description
Before version **1.9.20 - Raijin** inclusive the application uses incremental IDs and does not perform proper control over access to resources. By using a user with low privileges and enumerating the various IDs as "plan_id" it is possible to open and modify resources created by users with higher roles.

The CVE Program has assigned the ID CVE-2024-46097 to this issue. This is a record on the [CVE List](https://cve.mitre.org/cve/), which standardizes names for security problems:

**CVE ID: CVE-2024-46097** --> https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-46097

### Impacts
This vulnerability allows an attacker to modify the content of a high roles Users.

## CVE-2024-46097 - Incorrect Access Control

### Proof of concept (POC)
#### Reproducing Steps
For example, by accessing the "Test Plan Management" section with the Admin user it is possible to create a new Test Plan.

![immagine](https://github.com/user-attachments/assets/89dc8698-101a-4e67-aca7-6b0931bdd73d)

![immagine](https://github.com/user-attachments/assets/a299fbab-8438-4257-983f-cc970529787a)

Trying to open this Test Plan for editing you can see that "tpla_id" is assigned to it (the assigned IDs are always incremental).

Therefore, using a user with less elevated privileges, it is possible to open the Test Plan for editing, modify it and save it, as shown below.

![immagine](https://github.com/user-attachments/assets/6cf6887c-546a-4439-ac57-42ef63524ced)

By logging back in as the administrator user and rechecking the assigned Test Plans, you can notice the changes made by the user with a lower role.

![immagine](https://github.com/user-attachments/assets/4cffbe67-1df3-4ad7-bfa6-5ab0e10cf60b)

### Discovered by
#### [Kevin Riva](https://www.linkedin.com/in/kevin-riva-6338ba267/) of [Cybertech srl](https://www.cybertech.eu/)
